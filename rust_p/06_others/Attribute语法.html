<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Rust Attribute（属性）语法完整指南 | X-Lang</title><meta name="description" content="X-Lang: Code Smarter, in Every Language.">
    <link rel="preload" href="/assets/style-B3-VMakp.css" as="style"><link rel="stylesheet" href="/assets/style-B3-VMakp.css">
    <link rel="modulepreload" href="/assets/app-BX-AFFFx.js"><link rel="modulepreload" href="/assets/Attribute语法.html-BBhVnTNY.js">
    <link rel="prefetch" href="/assets/index.html-BNBNvjiJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DWbYuS9r.js" as="script"><link rel="prefetch" href="/assets/01_ownership.html-MAkUoGF9.js" as="script"><link rel="prefetch" href="/assets/02_borrowing.html-d_dEsquK.js" as="script"><link rel="prefetch" href="/assets/01_environment.html-D9OyjjX4.js" as="script"><link rel="prefetch" href="/assets/02_variables_types.html-NO8DG14s.js" as="script"><link rel="prefetch" href="/assets/03_control_flow.html-ClxisocK.js" as="script"><link rel="prefetch" href="/assets/04_functions.html-BGHu_SVL.js" as="script"><link rel="prefetch" href="/assets/01_structs_enums.html-D7ZimOob.js" as="script"><link rel="prefetch" href="/assets/02_collections.html-BcZzTNX6.js" as="script"><link rel="prefetch" href="/assets/01_error_handling.html-CAzsEHFX.js" as="script"><link rel="prefetch" href="/assets/02_modules_packages.html-CSBC4OKP.js" as="script"><link rel="prefetch" href="/assets/03_std_library_guide.html-xKyj62qi.js" as="script"><link rel="prefetch" href="/assets/01_calculator.html-D3GMHoVt.js" as="script"><link rel="prefetch" href="/assets/02_file_processor.html-BTFkgt-u.js" as="script"><link rel="prefetch" href="/assets/03_web_server.html-CPjy3so6.js" as="script"><link rel="prefetch" href="/assets/mod_rs和lib_rs的区别.html-DTtELQuO.js" as="script"><link rel="prefetch" href="/assets/可见性修饰符对比.html-adQc6Uk5.js" as="script"><link rel="prefetch" href="/assets/index.html-w7ZXNhnr.js" as="script"><link rel="prefetch" href="/assets/basic_exercises.html-b3swyvmf.js" as="script"><link rel="prefetch" href="/assets/404.html-aisI9-JU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/./images/logo.png" alt="X-Lang"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">X-Lang</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/rust_p/" aria-label="Rust 语言入门教程"><!--[--><!--[--><!--]--><!--]-->Rust 语言入门教程<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/rust_p/" aria-label="Rust 语言入门教程"><!--[--><!--[--><!--]--><!--]-->Rust 语言入门教程<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Rust Attribute（属性）语法完整指南 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><p>让我为你详细介绍 Rust 的 <strong>Attribute（属性）</strong> 语法。</p><p>[2 tools called]</p><h1 id="rust-attribute-属性-语法完整指南" tabindex="-1"><a class="header-anchor" href="#rust-attribute-属性-语法完整指南"><span>Rust Attribute（属性）语法完整指南</span></a></h1><h2 id="一、什么是-attribute" tabindex="-1"><a class="header-anchor" href="#一、什么是-attribute"><span><strong>一、什么是 Attribute？</strong></span></a></h2><p>Attribute 是 Rust 的元数据注解，用于：</p><ul><li>控制编译器行为</li><li>自动生成代码</li><li>配置条件编译</li><li>添加文档</li><li>标记测试函数</li></ul><h2 id="二、基本语法" tabindex="-1"><a class="header-anchor" href="#二、基本语法"><span><strong>二、基本语法</strong></span></a></h2><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 1. 外部属性 - 作用于下一个项目</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute]</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token type-definition class-name">MyStruct</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 2. 内部属性 - 作用于包含它的项目</span></span>
<span class="line"><span class="token attribute attr-name">#![attribute]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 3. 带参数的属性</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute(param)]</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute(key = <span class="token string">&quot;value&quot;</span>)]</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute(param1, param2)]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 4. 多行属性</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute1]</span></span>
<span class="line"><span class="token attribute attr-name">#[attribute2]</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token type-definition class-name">MyStruct</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、常见的内置-attribute" tabindex="-1"><a class="header-anchor" href="#三、常见的内置-attribute"><span><strong>三、常见的内置 Attribute</strong></span></a></h2><h3 id="_1-derive-自动实现-trait" tabindex="-1"><a class="header-anchor" href="#_1-derive-自动实现-trait"><span><strong>1. <code>#[derive(...)]</code> - 自动实现 trait</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 从你的项目中：</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug, Clone, Serialize, Deserialize, Record, Default)]</span></span>
<span class="line"><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">DexSummaryDetail</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">pub</span> summary<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>常见的派生 trait：</p><ul><li><code>Debug</code> - 调试打印（<code>{:?}</code>）</li><li><code>Clone</code> - 克隆能力</li><li><code>Copy</code> - 按位复制</li><li><code>PartialEq</code> / <code>Eq</code> - 相等比较</li><li><code>PartialOrd</code> / <code>Ord</code> - 排序比较</li><li><code>Default</code> - 默认值</li><li><code>Hash</code> - 哈希能力</li></ul><h3 id="_2-cfg-条件编译" tabindex="-1"><a class="header-anchor" href="#_2-cfg-条件编译"><span><strong>2. <code>#[cfg(...)]</code> - 条件编译</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 仅在测试时编译</span></span>
<span class="line"><span class="token attribute attr-name">#[cfg(test)]</span></span>
<span class="line"><span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 仅在 Unix 系统编译</span></span>
<span class="line"><span class="token attribute attr-name">#[cfg(target_os = <span class="token string">&quot;unix&quot;</span>)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">unix_only</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 仅在 debug 模式</span></span>
<span class="line"><span class="token attribute attr-name">#[cfg(debug_assertions)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">debug_only</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 仅在 Android 平台</span></span>
<span class="line"><span class="token attribute attr-name">#[cfg(target_os = <span class="token string">&quot;android&quot;</span>)]</span></span>
<span class="line"><span class="token keyword">use</span> jni<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-test-测试函数" tabindex="-1"><a class="header-anchor" href="#_3-test-测试函数"><span><strong>3. <code>#[test]</code> - 测试函数</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token attribute attr-name">#[test]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">test_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[test]</span></span>
<span class="line"><span class="token attribute attr-name">#[ignore]</span>  <span class="token comment">// 默认跳过此测试</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">expensive_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-allow-warn-deny-控制-lint" tabindex="-1"><a class="header-anchor" href="#_4-allow-warn-deny-控制-lint"><span><strong>4. <code>#[allow(...)]</code> / <code>#[warn(...)]</code> / <code>#[deny(...)]</code> - 控制 lint</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 允许未使用的变量</span></span>
<span class="line"><span class="token attribute attr-name">#[allow(unused_variables)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 警告废弃的代码</span></span>
<span class="line"><span class="token attribute attr-name">#[warn(deprecated)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 禁止不安全代码</span></span>
<span class="line"><span class="token attribute attr-name">#[deny(unsafe_code)]</span></span>
<span class="line"><span class="token keyword">mod</span> <span class="token module-declaration namespace">safe_module</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-deprecated-标记废弃" tabindex="-1"><a class="header-anchor" href="#_5-deprecated-标记废弃"><span><strong>5. <code>#[deprecated]</code> - 标记废弃</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token attribute attr-name">#[deprecated(since = <span class="token string">&quot;1.0.0&quot;</span>, note = <span class="token string">&quot;请使用 new_function 代替&quot;</span>)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">old_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-inline-内联提示" tabindex="-1"><a class="header-anchor" href="#_6-inline-内联提示"><span><strong>6. <code>#[inline]</code> - 内联提示</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 建议内联</span></span>
<span class="line"><span class="token attribute attr-name">#[inline]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">small_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 始终内联</span></span>
<span class="line"><span class="token attribute attr-name">#[inline(always)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">must_inline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 从不内联</span></span>
<span class="line"><span class="token attribute attr-name">#[inline(never)]</span></span>
<span class="line"><span class="token keyword">fn</span> <span class="token function-definition function">never_inline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="四、第三方库的-attribute" tabindex="-1"><a class="header-anchor" href="#四、第三方库的-attribute"><span><strong>四、第三方库的 Attribute</strong></span></a></h2><h3 id="_1-serde-序列化-反序列化" tabindex="-1"><a class="header-anchor" href="#_1-serde-序列化-反序列化"><span><strong>1. Serde - 序列化/反序列化</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 从你的项目中：</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Serialize, Deserialize)]</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(rename_all = <span class="token string">&quot;camelCase&quot;</span>, default)]</span>  <span class="token comment">// 容器级属性</span></span>
<span class="line"><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">DexSummaryData</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute attr-name">#[serde(default, deserialize_with = <span class="token string">&quot;de_opt_string_from_int_or_str&quot;</span>)]</span>  <span class="token comment">// 字段级属性</span></span>
<span class="line">    <span class="token keyword">pub</span> beta<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>常用 serde 属性：</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token attribute attr-name">#[serde(rename = <span class="token string">&quot;newName&quot;</span>)]</span>           <span class="token comment">// 重命名字段</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(rename_all = <span class="token string">&quot;camelCase&quot;</span>)]</span>     <span class="token comment">// 批量重命名</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(skip)]</span>                         <span class="token comment">// 跳过序列化</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(skip_serializing_if = <span class="token string">&quot;...&quot;</span>)]</span>  <span class="token comment">// 条件跳过</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(default)]</span>                      <span class="token comment">// 使用默认值</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(flatten)]</span>                      <span class="token comment">// 展平嵌套结构</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-thiserror-错误处理" tabindex="-1"><a class="header-anchor" href="#_2-thiserror-错误处理"><span><strong>2. Thiserror - 错误处理</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 从你的项目中：</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug, thiserror::Error)]</span></span>
<span class="line"><span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">GatewayError</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute attr-name">#[error(<span class="token string">&quot;network: {0}&quot;</span>)]</span></span>
<span class="line">    <span class="token class-name">Network</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token attribute attr-name">#[error(<span class="token string">&quot;parse: {0}&quot;</span>)]</span></span>
<span class="line">    <span class="token class-name">Parse</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token attribute attr-name">#[error(<span class="token string">&quot;request factory not registered&quot;</span>)]</span></span>
<span class="line">    <span class="token class-name">NoFactory</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-uniffi-跨语言绑定" tabindex="-1"><a class="header-anchor" href="#_3-uniffi-跨语言绑定"><span><strong>3. UniFFI - 跨语言绑定</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token attribute attr-name">#[derive(uniffi::Record)]</span>  <span class="token comment">// 生成 FFI 绑定</span></span>
<span class="line"><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">DexSummaryDetail</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">pub</span> summary<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[derive(uniffi::Error)]</span></span>
<span class="line"><span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">MyError</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">NetworkError</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-tokio-异步运行时" tabindex="-1"><a class="header-anchor" href="#_4-tokio-异步运行时"><span><strong>4. Tokio - 异步运行时</strong></span></a></h3><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token comment">// 异步测试</span></span>
<span class="line"><span class="token attribute attr-name">#[tokio::test]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">async_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 异步代码</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 异步主函数</span></span>
<span class="line"><span class="token attribute attr-name">#[tokio::main]</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 异步代码</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、完整示例-从你的项目" tabindex="-1"><a class="header-anchor" href="#五、完整示例-从你的项目"><span><strong>五、完整示例（从你的项目）</strong></span></a></h2><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs"><pre><code><span class="line"><span class="token keyword">use</span> <span class="token namespace">serde<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Deserialize</span><span class="token punctuation">,</span> <span class="token class-name">Serialize</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token namespace">uniffi<span class="token punctuation">::</span></span><span class="token class-name">Record</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 多个 derive 宏</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug, Clone, Serialize, Deserialize, Record, Default)]</span></span>
<span class="line"><span class="token comment">// serde 配置</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(rename_all = <span class="token string">&quot;camelCase&quot;</span>, default)]</span></span>
<span class="line"><span class="token comment">// 自定义可见性</span></span>
<span class="line"><span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">DexSummaryDetail</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> summary<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> translated_summary<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> updated_time<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug, Clone, Serialize, Deserialize, Record, Default)]</span></span>
<span class="line"><span class="token attribute attr-name">#[serde(rename_all = <span class="token string">&quot;camelCase&quot;</span>, default)]</span></span>
<span class="line"><span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">DexSummaryData</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 字段级 serde 配置</span></span>
<span class="line">    <span class="token attribute attr-name">#[serde(default, deserialize_with = <span class="token string">&quot;de_opt_string_from_int_or_str&quot;</span>)]</span></span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> beta<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> mention_detail<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>biz_service<span class="token punctuation">::</span></span>dex<span class="token punctuation">)</span> summary_detail<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">DexSummaryDetail</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-10-18T08:44:47.000Z" data-allow-mismatch>10/18/25, 8:44 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1030360567@qq.com">uponup</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BX-AFFFx.js" defer></script>
  </body>
</html>
